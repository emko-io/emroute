# 1.5.0 Open Issues

Issues discovered during manual testing of the four SPA modes after the 1.5.0
refactoring (Shadow DOM, configurable basePath, trailing slash normalization).

## Shadow DOM Consequences

### Search broken in all modes

Inline `oninput` handler in `search-filter` widget does
`document.querySelectorAll('#article-list>*')` which can't cross shadow boundaries.
The target `#article-list` lives in the parent page's shadow root, unreachable from
the widget's shadow root. **Affects all modes**, not just `none`.
See: `shadow-dom-cross-boundary-queries.issue.md`

### `data-ssr` attribute bloat

Widget params are stored twice: once as HTML attributes, once inside the `data-ssr`
JSON blob. Increases HTML size, harder to read.
See: `data-ssr-attribute-bloat.issue.md`

## No-JS (`none` mode)

### Preact widget renders empty green boxes

`counter-htm` widget's `renderHTML()` produces an empty `<div>` — the `<noscript>`
fallback exists but the SSR content itself is meaningless without JS.
Fix: `renderHTML()` should produce static content (initial count value).

### Articles search needs GET form pattern

Replace client-side-only filtering with `<form method="get">` so the server can
filter via `context.searchParams`. Works in all modes, URL becomes shareable.
See: `search-get-form-pattern.issue.md`

### About page — no error from throwing widget

`failing` widget throws in `getData()` but no error message renders in `none` mode.
SSR error rendering for widgets needs review.

### Widget no-JS audit needed

All fixture widgets need review: do they produce meaningful SSR output without JS?
Widgets requiring JS should use `<noscript>` with a clear message.
See: `widgets-no-js-audit.issue.md`

### Global styles in main.css

`none` mode has no JS to load component styles. Important global styles should
live in `main.css` so they're available via `<link>` in the HTML shell.

## Fixture Bugs

### articles/triple-rendering — broken in all modes, differently

`articles.page.html` is missing `<router-slot></router-slot>`. Without a slot:

- **SSR (`none`/`leaf`/`root`)**: `injectSlot` regex finds the FIRST
  `<router-slot>` in the accumulated string — which is a duplicate slot from
  `index.page.md` (root layout). The root produces TWO slots: one from the
  markdown `` ```router-slot `` block, one appended by default `renderHTML`. Child
  content gets injected into the root's spare slot, appearing after the "# emroute"
  content. **Partially fixed**: `isLeaf` check now prevents leaf routes from
  appending unnecessary slots.
- **SPA (`only`)**: router uses `querySelector('router-slot')` on the DOM, finds
  no nested slot in articles content, `currentSlot` stays the outer slot, next
  iteration's `innerHTML = html` **replaces** the parent entirely.

Both are wrong. Fix: add `<router-slot></router-slot>` to the fixture template.
See: `scoped-router-slot.issue.md` for the deeper framework fix.

## Router Slot Scoping

### `injectSlot` is not scoped to the parent that produced the slot

See: `scoped-router-slot.issue.md`

## Expected Behavior (not bugs)

- **`none` guide tabs are interactive** — uses inline `onclick` handlers, no bundle needed.
- **`root` bundle is ~3x bigger than `leaf`** — includes SPA router, route manifest, and all page modules. `leaf` only has widget registration.
